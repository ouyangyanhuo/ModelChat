function showError(e){document.getElementById("error-container").innerHTML=`\n        <div class="error-message bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">\n            <div class="flex items-center">\n                <i class="fas fa-exclamation-circle mr-2"></i>\n                <span>${e}</span>\n            </div>\n        </div>\n    `}document.getElementById("set-password-form").addEventListener("submit",async function(e){e.preventDefault();const t=document.getElementById("new_password").value,n=document.getElementById("confirm_password").value,r=document.querySelector(".auth-button"),s=document.getElementById("set-password-text");s.innerHTML='<i class="fas fa-spinner fa-spin"></i> 设置中...',r.disabled=!0;try{const e=await fetch("/set_password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({new_password:t,confirm_password:n})}),o=await e.json();e.ok?window.location.href=o.redirect:(showError(o.error),s.textContent="设置密码并登录",r.disabled=!1)}catch(e){showError("网络错误，请稍后重试"),s.textContent="设置密码并登录",r.disabled=!1}});